<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>渐变壁纸生成器</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            transition: background-color 0.5s ease;
            /* 设置默认背景渐变 */
            background: linear-gradient(to bottom, #EEA0A0, #6568C3);
        }
    </style>
</head>

<body class="flex flex-col items-center justify-center h-screen m-0 bg-gradient-to-b from-black to-white transition-colors duration-500">
    <div class="bg-white/80 p-5 rounded-md shadow-md mb-5">
        <div class="mb-2">
            <label for="color1" class="block mb-1">起始颜色</label>
            <input type="color" id="color1" value="#EEA0A0" class="border border-gray-300 rounded-md">
        </div>
        <div class="mb-2">
            <label for="color2" class="block mb-1">结束颜色</label>
            <input type="color" id="color2" value="#6568C3" class="border border-gray-300 rounded-md">
        </div>
        <div class="mb-2">
            <label for="direction" class="block mb-1">渐变方向</label>
            <select id="direction" class="border border-gray-300 rounded-md">
                <option value="to bottom">从上到下</option>
                <option value="to right">从左到右</option>
                <option value="to bottom right">从左上到右下</option>
                <option value="to bottom left">从右上到左下</option>
            </select>
        </div>
        <div class="mb-2">
            <label for="opacity" class="block mb-1">透明度</label>
            <input type="range" id="opacity" min="0" max="1" step="0.01" value="1" class="border border-gray-300 rounded-md">
        </div>
        <button id="apply" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">应用</button>
        <button id="save" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">保存为壁纸</button>
            <p>&copy; 2025 小王</p>
    </div>

    <script>
        const color1Input = document.getElementById('color1');
        const color2Input = document.getElementById('color2');
        const directionSelect = document.getElementById('direction');
        const opacityInput = document.getElementById('opacity');
        const applyButton = document.getElementById('apply');
        const saveButton = document.getElementById('save');

        function updateBackground() {
            const color1 = color1Input.value;
            const color2 = color2Input.value;
            const direction = directionSelect.value;
            const opacity = opacityInput.value;

            const rgbaColor1 = hexToRGBA(color1, opacity);
            const rgbaColor2 = hexToRGBA(color2, opacity);

            document.body.style.background = `linear-gradient(${direction}, ${rgbaColor1}, ${rgbaColor2})`;
        }

        // 页面加载时设置默认背景
        window.addEventListener('load', () => {
            const defaultColor1 = color1Input.value;
            const defaultColor2 = color2Input.value;
            const defaultDirection = directionSelect.value;
            const defaultOpacity = opacityInput.value;

            const defaultRgbaColor1 = hexToRGBA(defaultColor1, defaultOpacity);
            const defaultRgbaColor2 = hexToRGBA(defaultColor2, defaultOpacity);

            document.body.style.background = `linear-gradient(${defaultDirection}, ${defaultRgbaColor1}, ${defaultRgbaColor2})`;
        });

        applyButton.addEventListener('click', updateBackground);

        saveButton.addEventListener('click', () => {
            const color1 = color1Input.value;
            const color2 = color2Input.value;
            const direction = directionSelect.value;
            const opacity = opacityInput.value;

            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const fixedWidth = window.innerWidth;
            const fixedHeight = window.innerHeight;
            canvas.width = fixedWidth;
            canvas.height = fixedHeight;

            let gradient;
            if (direction === 'to bottom') {
                gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            } else if (direction === 'to right') {
                gradient = ctx.createLinearGradient(0, 0, canvas.width, 0);
            } else if (direction === 'to bottom right') {
                gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            } else if (direction === 'to bottom left') {
                gradient = ctx.createLinearGradient(canvas.width, 0, 0, canvas.height);
            }

            const rgbaColor1 = hexToRGBA(color1, opacity);
            const rgbaColor2 = hexToRGBA(color2, opacity);

            gradient.addColorStop(0, rgbaColor1);
            gradient.addColorStop(1, rgbaColor2);

            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = 'gradient_wallpaper.png';
            link.click();
        });

        function hexToRGBA(hex, opacity) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r}, ${g}, ${b}, ${opacity})`;
        }
    </script>
</body>

</html>